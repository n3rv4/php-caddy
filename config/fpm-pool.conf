[www]
listen = /run/php/php-fpm.sock
listen.backlog = 1024
listen.owner = www-data
listen.group = www-data
listen.mode = 0660

; --- gestion des processus ---
pm = dynamic
pm.max_children = 32            ; ajuste selon la RAM (voir formule)
pm.start_servers = 8
pm.min_spare_servers = 8
pm.max_spare_servers = 16
pm.max_requests = 800

; --- timeouts / robustesse ---
request_terminate_timeout = 60s
;request_terminate_timeout_track_finished = yes

; --- logs / debug perf ---
slowlog = /tmp/php-fpm.slow.log
request_slowlog_timeout = 5s

; --- status + ping ---
pm.status_path = /fpm-status
ping.path = /fpm-ping
ping.response = pong

; --- confort / limites ---
rlimit_files = 4096
catch_workers_output = yes
decorate_workers_output = no
clear_env = no